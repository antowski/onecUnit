
Перем мПроверить;
Перем мРезультат;

Перем мКолПровалено;
Перем мКолЗапущено;
Перем мКолЗавершено;

Процедура Конструктор()
	
	мПроверить = СоздатьОбъект("Утверждения");
	
	мРезультат = СоздатьОбъект("РезультатТеста");
	мРезультат.ДобавитьПодписчика(Я());
	
КонецПроцедуры // Конструктор

Процедура Деструктор()
	мРезультат = "";
КонецПроцедуры // Деструктор

Процедура ПередВыполнением() Экспорт
	мКолЗапущено = 0;
	мКолПровалено = 0;
	мКолЗавершено = 0;
КонецПроцедуры // ПередВыполнением

//{ интерфейс подписчика

Процедура ПриЗапуске(пТест) Экспорт
	мКолЗапущено = мКолЗапущено + 1;
КонецПроцедуры

Процедура ПриЗавершении(пТест) Экспорт
	мКолЗавершено = мКолЗавершено + 1;
КонецПроцедуры

Процедура ПриПровале(пТест, пОшибкаСтр) Экспорт
	мКолПровалено = мКолПровалено + 1;
КонецПроцедуры

//}

Процедура ПроверитьПровал()
	мПроверить.Равно(1, мКолЗапущено);
	мПроверить.Равно(1, мКолПровалено);
	мПроверить.Равно(1, мКолЗавершено);
КонецПроцедуры // ПроверитьПровал

Процедура ПроверитьУспех()
	мПроверить.Равно(1, мКолЗапущено);
	мПроверить.Равно(0, мКолПровалено);
	мПроверить.Равно(1, мКолЗавершено);
КонецПроцедуры // ПроверитьУспех

//{ тесты

Процедура тестРегистрацияПровала() Экспорт
	
	Тест = СоздатьОбъект("Фикстура.БылВыполнен");
	Тест.Инит("СломанныйТест");
	
	Тест.Выполнить(мРезультат);
	
	ПроверитьПровал();
	
КонецПроцедуры // тестРегистрацияПровала

Процедура тестРегистрацияЗапускаИЗавершения() Экспорт
	
	Тест = СоздатьОбъект("Фикстура.БылВыполнен");
	Тест.Инит("ТестовыйМетод");
	
	Тест.Выполнить(мРезультат);
	
	ПроверитьУспех();
	
КонецПроцедуры // тестРегистрацияПровала

//}
