
Перем мПодписчик;

Процедура Конструктор()
	мПодписчик = "";
КонецПроцедуры

Процедура ДобавитьПодписчика(пПодписчик) Экспорт
	мПодписчик = пПодписчик;
КонецПроцедуры // ДобавитьПодписчика

Процедура ЗапуститьТесты() Экспорт
	
	Нач = _getPerformanceCounter();
	
	мПодписчик.ТестЗапущен();
	
	КолСекВыполнять = 3;
	КолСекундВыполняем = 0;
	Пока КолСекундВыполняем < КолСекВыполнять Цикл
		
		Тек = _getPerformanceCounter();
		
		Если Тек % 1173 = 0 Тогда
			мПодписчик.ТестУпал();
		ИначеЕсли Тек % 371 = 0 Тогда
			мПодписчик.ТестВыполненУспешно();
		ИначеЕсли Тек % 178 = 0 Тогда
			мПодписчик.ТестЗапущен();
		КонецЕсли;
		
		КолСекундВыполняем = Окр((Тек - Нач) / 1000, 2);
		
		Состояние(КолСекундВыполняем);
		
	КонецЦикла;
	
КонецПроцедуры // ЗапуститьТесты
